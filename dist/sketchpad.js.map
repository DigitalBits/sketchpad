{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 115be74fcabf065e5ea9","webpack:///./lib/sketchpad.js"],"names":["Sketchpad","options","canvas","element","console","error","document","querySelector","forEach","attr","getAttribute","width","height","color","penSize","readOnly","strokes","_strokesFormat","undoHistory","onMouseMove","bind","style","cursor","events","internalEvents","name","lower","toLowerCase","addEventListener","args","trigger","reset","event","x","pageX","offsetLeft","y","pageY","offsetTop","stroke","type","context","clearRect","lines","_line","line","size","start","end","compositeOperation","save","lineJoin","lineCap","strokeStyle","lineWidth","globalCompositeOperation","beginPath","moveTo","lineTo","closePath","restore","str","data","result","group","split","splice","positions","map","push","_lineToArray","_sketching","_lastPosition","_position","_currentStroke","current","removeEventListener","onMouseUp","currentPosition","_draw","JSON","parse","stringify","toObject","filter","_lineToString","pop","_stroke","redraw","url","image","Image","src","toDataURL","getContext","off","on","animateIds","id","clearTimeout","interval","loop","loopInterval","delay","cancelAnimation","setTimeout","animate","action","callback","undefined","index","indexOf","window","module","exports"],"mappings":"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","file":"sketchpad.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"module\"] = factory();\n\telse\n\t\troot[\"module\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 115be74fcabf065e5ea9","class Sketchpad {\n  constructor(options) {\n    // Support both old api (element) and new (canvas)\n    options.canvas = options.canvas || options.element;\n    if (!options.canvas) {\n      console.error('[SKETCHPAD]: Please provide an element/canvas:');\n      return;\n    }\n\n    if (typeof options.canvas === 'string') {\n      options.canvas = document.querySelector(options.canvas);\n    }\n\n    this.canvas = options.canvas;\n\n    // Try to extract 'width', 'height', 'color', 'penSize' and 'readOnly'\n    // from the options or the DOM element.\n    ['width', 'height', 'color', 'penSize', 'readOnly'].forEach((attr) => {\n      this[attr] = options[attr] || this.canvas.getAttribute('data-' + attr);\n    }, this);\n\n    // Setting default values\n    this.width = this.width || 0;\n    this.height = this.height || 0;\n\n    this.color = this.color || '#000';\n    this.penSize = this.penSize || 5;\n\n    this.readOnly = this.readOnly || false;\n\n    // Sketchpad History settings\n    this.strokes = options.strokes ? this._strokesFormat(options.strokes) : [];\n\n    this.undoHistory = options.undoHistory || [];\n\n    // Enforce context for Moving Callbacks\n    this.onMouseMove = this.onMouseMove.bind(this);\n\n    this.canvas.style.cursor = 'crosshair';\n\n    // Setup Internal Events\n    this.events = {};\n    this.events['mousemove'] = [];\n    this.internalEvents = ['MouseDown', 'MouseUp', 'MouseOut'];\n    this.internalEvents.forEach((name) => {\n      let lower = name.toLowerCase();\n      this.events[lower] = [];\n\n      // Enforce context for Internal Event Functions\n      this['on' + name] = this['on' + name].bind(this);\n\n      // Add DOM Event Listeners\n      this.canvas.addEventListener(lower, (...args) => this.trigger(lower, args));\n    }, this);\n\n    this.reset();\n  }\n\n  /*\n   * Private API\n   */\n\n  _position(event) {\n    const x = event.pageX - this.canvas.offsetLeft;\n    const y = event.pageY - this.canvas.offsetTop;\n\n    return [x, y];\n  }\n\n  _stroke(stroke) {\n    if (stroke.type === 'clear') {\n      return this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    }\n\n    stroke.lines.forEach(line => {\n      this._line(line[0], line[1], stroke.color, stroke.size);\n    }, this);\n  }\n\n  _draw(start, end, color, size) {\n    this._line(start, end, color, size, 'source-over');\n  }\n\n  _erase(start, end, color, size) {\n    this._line(start, end, color, size, 'destination-out');\n  }\n\n  _line(start, end, color, size, compositeOperation) {\n    this.context.save();\n    this.context.lineJoin = 'round';\n    this.context.lineCap = 'round';\n    this.context.strokeStyle = color;\n    this.context.lineWidth = size;\n    this.context.globalCompositeOperation = compositeOperation;\n    this.context.beginPath();\n    this.context.moveTo(start[0], start[1]);\n    this.context.lineTo(end[0], end[1]);\n    this.context.closePath();\n    this.context.stroke();\n    this.context.restore();\n  }\n\n  _lineToString(start, end) {\n    const str = `M${start[0]},${start[1]}L${end[0]},${end[1]}`;\n\n    return str;\n  }\n\n  _lineToArray(data) {\n    let result = [];\n    let group = data.split(\"M\");\n\n    group.splice(0, 1);\n\n    group.forEach(element => {\n      const positions = element.split(\"L\");\n      let lines = positions.map(line => line.split(\",\"));\n\n      result.push(lines);\n    });\n\n    return result;\n  }\n\n  _strokesFormat(data) {\n    const strokes = data.map(stroke => {\n      stroke.lines = this._lineToArray(stroke.lines);\n      return stroke;\n    });\n\n    return strokes;\n  }\n\n  /*\n   * Events/Callback\n   */\n\n  onMouseDown(event) {\n    this._sketching = true;\n    this._lastPosition = this._position(event);\n    this._currentStroke = {\n      color: this.color,\n      size: this.penSize,\n      current: true,\n      lines: [],\n    };\n\n    this.canvas.addEventListener('mousemove', this.onMouseMove);\n  }\n\n  onMouseUp(event) {\n    if (this._sketching) {\n      this.strokes.push(this._currentStroke);\n      this._sketching = false;\n    }\n\n    this.canvas.removeEventListener('mousemove', this.onMouseMove);\n  }\n\n  onMouseOut(event) {\n    this.onMouseUp(event);\n  }\n\n  onMouseMove(event) {\n    let currentPosition = this._position(event);\n\n    this._draw(this._lastPosition, currentPosition, this.color, this.penSize);\n    this._currentStroke.lines.push([this._lastPosition, currentPosition]);\n    this._lastPosition = currentPosition;\n\n    this.trigger('mousemove', [event]);\n  }\n\n  /*\n   * Public API\n   */\n\n  toObject() {\n    return {\n      width: this.canvas.width,\n      height: this.canvas.height,\n      strokes: this.strokes,\n      undoHistory: this.undoHistory,\n    };\n  }\n\n  toJSON() {\n    let data = JSON.parse(JSON.stringify(this.toObject()));\n\n    data.strokes = data.strokes\n      .filter((stroke) => stroke.current)\n      .map(stroke => {\n        let lines = '';\n\n        if (!stroke.lines) {\n          return false;\n        }\n\n        stroke.lines.forEach(line => {\n          lines += this._lineToString(line[0], line[1]);\n        });\n\n        stroke.lines = lines;\n        return stroke;\n      })\n\n    return data;\n  }\n\n  redo() {\n    var stroke = this.undoHistory.pop();\n    if (stroke) {\n      this.strokes.push(stroke);\n      this._stroke(stroke);\n    }\n  }\n\n  undo() {\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    var stroke = this.strokes.pop();\n    this.redraw();\n\n    if (stroke) {\n      this.undoHistory.push(stroke);\n    }\n  }\n\n  toImage(url) {\n    let image = new Image();\n    let canvas = this.canvas;\n\n    image.src = canvas.toDataURL(\"image/png\");\n    return image;\n  }\n\n  clear() {\n    this.strokes.push({\n      type: 'clear',\n    });\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n  }\n\n  redraw() {\n    this.strokes.forEach(stroke => {\n      this._stroke(stroke);\n    }, this);\n  }\n\n  reset() {\n    // Setup canvas\n    this.canvas.width = this.width;\n    this.canvas.height = this.height;\n    this.context = this.canvas.getContext('2d');\n\n    // Redraw image\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.redraw();\n\n    // Remove all event listeners, this way readOnly option will be respected\n    // on the reset\n    this.internalEvents.forEach(name => this.off(name.toLowerCase()));\n\n    if (this.readOnly) {\n      return;\n    }\n\n    // Re-Attach all event listeners\n    this.internalEvents.forEach(name => this.on(name.toLowerCase(), this['on' + name]));\n  }\n\n  cancelAnimation() {\n    this.animateIds = this.animateIds || [];\n    this.animateIds.forEach(function (id) {\n      clearTimeout(id);\n    });\n    this.animateIds = [];\n  }\n\n  animate(interval = 10, loop = false, loopInterval = 0) {\n    let delay = interval;\n\n    this.cancelAnimation();\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n    this.strokes.forEach(stroke => {\n      if (stroke.type === 'clear') {\n        delay += interval;\n        return this.animateIds.push(setTimeout(() => {\n          this.context.clearRect(0, 0, this.canvas.width,\n            this.canvas.height);\n        }, delay));\n      }\n\n      stroke.lines.forEach(line => {\n        delay += interval;\n        this.animateIds.push(setTimeout(() => {\n          this._draw(line.start, line.end, stroke.color, stroke.size);\n        }, delay));\n      });\n    });\n\n    if (loop) {\n      this.animateIds.push(setTimeout(() => {\n        this.animate(interval = 10, loop, loopInterval);\n      }, delay + interval + loopInterval));\n    }\n\n    this.animateIds(setTimeout(() => {\n      this.trigger('animation-end', [interval, loop, loopInterval]);\n    }, delay + interval));\n  }\n\n  /*\n   * Event System\n   */\n\n  /* Attach an event callback\n   *\n   * @param {String} action Which action will have a callback attached\n   * @param {Function} callback What will be executed when this event happen\n   */\n  on(action, callback) {\n    // Tell the user if the action he has input was invalid\n    if (this.events[action] === undefined) {\n      return console.error(`Sketchpad: No such action '${action}'`);\n    }\n\n    this.events[action].push(callback);\n  }\n\n  /* Detach an event callback\n   *\n   * @param {String} action Which action will have event(s) detached\n   * @param {Function} callback Which function will be detached. If none is\n   *                            provided, all callbacks are detached\n   */\n  off(action, callback) {\n    if (callback) {\n      // If a callback has been specified delete it specifically\n      var index = this.events[action].indexOf(callback);\n      (index !== -1) && this.events[action].splice(index, 1);\n      return index !== -1;\n    }\n\n    // Else just erase all callbacks\n    this.events[action] = [];\n  }\n\n  /* Trigger an event\n   *\n   * @param {String} action Which event will be triggered\n   * @param {Array} args Which arguments will be provided to the callbacks\n   */\n  trigger(action, args = []) {\n    // Fire all events with the given callback\n    this.events[action].forEach((callback) => {\n      callback(...args);\n    });\n  }\n}\n\nwindow.Sketchpad = Sketchpad;\nmodule.exports = Sketchpad;\n\n\n// WEBPACK FOOTER //\n// ./lib/sketchpad.js"],"sourceRoot":""}